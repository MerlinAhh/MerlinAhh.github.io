<!DOCTYPE html>
<html lang=zh>
  <head>
  <meta charset="utf-8">
  
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
      <meta name="renderer" content="webkit">
      <meta http-equiv="Cache-Control" content="no-transform" />
      <meta http-equiv="Cache-Control" content="no-siteapp" />
      <meta name="apple-mobile-web-app-capable" content="yes">
      <meta name="apple-mobile-web-app-status-bar-style" content="black">
      <meta name="format-detection" content="telephone=no,email=no,adress=no">
      <!-- Color theme for statusbar -->
      <meta name="theme-color" content="#000000" />
      <!-- 强制页面在当前窗口以独立页面显示,防止别人在框架里调用页面 -->
      <meta http-equiv="window-target" content="_top" />
      
          
            <title>
              
                Linux 用户管理及用户权限设置 | 
                    Merlin の 博客
            </title>
            <meta name="description" content="Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。 用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。 每个用户账号都拥有一个惟一的用户名和各自的口令。 用户在登录时键入正确的用户名和口令后，就能够进入系统和自">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux 用户管理及用户权限设置">
<meta property="og:url" content="https://merlinahh.github.io/2019/02/17/Linux-user-sudo/index.html">
<meta property="og:site_name" content="Merlinの博客">
<meta property="og:description" content="Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。 用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。 每个用户账号都拥有一个惟一的用户名和各自的口令。 用户在登录时键入正确的用户名和口令后，就能够进入系统和自">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2019-02-17T00:49:41.000Z">
<meta property="article:modified_time" content="2024-02-28T00:43:56.557Z">
<meta property="article:author" content="Merlin">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
              <!-- Canonical links -->
              <link rel="canonical" href="https://merlinahh.github.io/2019/02/17/Linux-user-sudo/index.html">
              
                <link rel="alternate" href="/atom.xml" title="Merlinの博客" type="application/atom+xml">
                
                  
                    <link rel="icon" href="/favicon.ico" type="image/x-icon">
                    
                      
<link rel="stylesheet" href="/css/style.css">

                        
<link rel="stylesheet" href="/fonts/iconfont.css">

                          
                              
                                  
                                    <link
                                      href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.css"
                                      rel="stylesheet">
                                    
                                      
<meta name="generator" content="Hexo 5.4.1"></head>
    

      <body class="main-center" itemscope itemtype="http://schema.org/WebPage">
        <header class="header" itemscope itemtype="http://schema.org/WPHeader"
  style="background-image: url(/images/bg.png); background-position: -50px bottom; background-repeat: no-repeat;">
  <div class="slimContent">
    <div class="navbar-header">
      
        
          <div class="profile-block text-center">
            <a id="avatar" href="/" target="_blank">
              <img
                src="/logo.png"
                width="200" height="200">
            </a>
            <h2 id="name" class="hidden-xs hidden-sm">
              Merlin の 博客
            </h2>
            <h3 id="title" class="hidden-xs hidden-sm hidden-md">
              Frontend Developer
            </h3>
            <small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i>
              Wuhan, China
            </small>
          </div>
          
            <div class="search" id="search-form-wrap">

    <form class="search-form sidebar-form">
        <div class="input-group">
            <input type="text" class="search-form-input form-control" placeholder="搜索" />
            <span class="input-group-btn">
                <button type="submit" class="search-form-submit btn btn-flat" onclick="return false;"><i class="icon icon-search"></i></button>
            </span>
        </div>
    </form>
    <div class="ins-search">
  <div class="ins-search-mask"></div>
  <div class="ins-search-container">
    <div class="ins-input-wrapper">
      <input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech />
      <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
    </div>
    <div class="ins-section-wrapper">
      <div class="ins-section-container"></div>
    </div>
  </div>
</div>


</div>
              <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar"
                aria-controls="main-navbar" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
    </div>
    <nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement"
      role="navigation">
      <ul class="nav navbar-nav main-nav menu-highlight">
        
          
            <li class="menu-item menu-item-home">
              <a href="/.">
                
                  <i class="icon icon-home"></i>
                  
                    <span class="menu-title">
                      首页
                    </span>
              </a>
            </li>
            
          
            <li class="menu-item menu-item-archives">
              <a href="/archives">
                
                  <i class="icon icon-archives"></i>
                  
                    <span class="menu-title">
                      归档
                    </span>
              </a>
            </li>
            
          
            <li class="menu-item menu-item-categories">
              <a href="/categories">
                
                  <i class="icon icon-category"></i>
                  
                    <span class="menu-title">
                      分类
                    </span>
              </a>
            </li>
            
          
            <li class="menu-item menu-item-tags">
              <a href="/tags">
                
                  <i class="icon icon-tag"></i>
                  
                    <span class="menu-title">
                      标签
                    </span>
              </a>
            </li>
            
          
            <li class="menu-item menu-item-gallery">
              <a href="/gallery">
                
                  <i class="icon icon-gallery"></i>
                  
                    <span class="menu-title">
                      图库
                    </span>
              </a>
            </li>
            
          
            <li class="menu-item menu-item-links">
              <a href="/links">
                
                  <i class="icon icon-frilink"></i>
                  
                    <span class="menu-title">
                      友链
                    </span>
              </a>
            </li>
            
      </ul>
      
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/MerlinAhh" target="_blank" title="Github-Fill" ><i class="icon icon-github-fill"></i></a></li>
        
        <li><a href="https://huaban.com/user/merlinahh" target="_blank" title="Huaban" ><i class="icon icon-huaban"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss-Fill" ><i class="icon icon-rss-fill"></i></a></li>
        
    </ul>

    </nav>
  </div>
</header>
          
            <aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar">
  <div class="slimContent">
    
      <div class="widget">
    <h3 class="widget-title">公告</h3>
    <div class="widget-body">
        <div id="board">
            <div class="content">
                <p>欢迎交流与分享经验!</p>
            </div>
        </div>
    </div>
</div>

    
      
  <div class="widget">
    <h3 class="widget-title">分类</h3>
    <div class="widget-body">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><span class="category-list-count">27</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a><span class="category-list-count">6</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">标签云</h3>
    <div class="widget-body tagcloud">
      <a href="/tags/GitHub-Page/" style="font-size: 13.43px;">GitHub Page</a> <a href="/tags/HEXO/" style="font-size: 13.43px;">HEXO</a> <a href="/tags/HTML-CSS/" style="font-size: 13.14px;">HTML+CSS</a> <a href="/tags/Linux/" style="font-size: 13.57px;">Linux</a> <a href="/tags/MongoDB/" style="font-size: 13px;">MongoDB</a> <a href="/tags/Nginx/" style="font-size: 13px;">Nginx</a> <a href="/tags/Node-js/" style="font-size: 13.29px;">Node.js</a> <a href="/tags/RegExp/" style="font-size: 13.14px;">RegExp</a> <a href="/tags/VUE/" style="font-size: 13.14px;">VUE</a> <a href="/tags/js/" style="font-size: 13.86px;">js</a> <a href="/tags/node/" style="font-size: 13px;">node</a> <a href="/tags/scp/" style="font-size: 13px;">scp</a> <a href="/tags/shell%E8%84%9A%E6%9C%AC/" style="font-size: 13px;">shell脚本</a> <a href="/tags/yarn/" style="font-size: 13px;">yarn</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 13.14px;">前端</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 13.71px;">小程序</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 14px;">笔记</a>
    </div>
  </div>

    
      
  <div class="widget">
    <h3 class="widget-title">归档</h3>
    <div class="widget-body">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2025/">2025</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/">2024</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/">2022</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/">2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/">2019</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/">2018</a><span class="archive-list-count">7</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/">2017</a><span class="archive-list-count">13</span></li></ul>
    </div>
  </div>


    
      
  <div class="widget">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget-body">
      <ul class="recent-post-list list-unstyled no-thumbnail">
        
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
              </p>
              <p class="item-title">
                <a href="/2025/02/05/Mac-install-develop/" class="title">Mac 安装配置前端开发环境</a>
              </p>
              <p class="item-date">
                <time datetime="2025-02-05T02:42:00.000Z" itemprop="datePublished">2025-02-05</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
              </p>
              <p class="item-title">
                <a href="/2024/03/11/vue3vite/" class="title">Vue3 + Vite 项目搭建</a>
              </p>
              <p class="item-date">
                <time datetime="2024-03-11T05:27:42.000Z" itemprop="datePublished">2024-03-11</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
              </p>
              <p class="item-title">
                <a href="/2022/02/28/nvm-node/" class="title">使用 nvm 来管理 node版本</a>
              </p>
              <p class="item-date">
                <time datetime="2022-02-28T00:09:31.000Z" itemprop="datePublished">2022-02-28</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a>
              </p>
              <p class="item-title">
                <a href="/2022/02/17/trsndformTime/" class="title">时间戳转具体日时分秒</a>
              </p>
              <p class="item-date">
                <time datetime="2022-02-17T07:26:01.000Z" itemprop="datePublished">2022-02-17</time>
              </p>
            </div>
          </li>
          
          <li>
            
            <div class="item-inner">
              <p class="item-category">
                <a class="category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>
              </p>
              <p class="item-title">
                <a href="/2020/07/21/scp-upload-files/" class="title">很好用的 scp 上传文件脚本</a>
              </p>
              <p class="item-date">
                <time datetime="2020-07-21T05:11:49.000Z" itemprop="datePublished">2020-07-21</time>
              </p>
            </div>
          </li>
          
      </ul>
    </div>
  </div>
  

    
  </div>
</aside>

              
                
  <main class="main" role="main">
    <div class="content">
  <article id="post-Linux-user-sudo" class="article article-type-post fancy-article"
    itemscope itemtype="http://schema.org/BlogPosting">
    
      <div class="article-header">
        
          
  
    <h1 class="article-title" itemprop="name">
      Linux 用户管理及用户权限设置
    </h1>
  

            
              <div class="article-meta">
                <span class="article-date">
    <i class="icon icon-calendar-check"></i>
	<a href="/2019/02/17/Linux-user-sudo/" class="article-date">
	  <time datetime="2019-02-17T00:49:41.000Z" itemprop="datePublished">2019-02-17</time>
	</a>
</span>
                  
  <span class="article-category">
    <i class="icon icon-category"></i>
    <a class="article-category-link" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>
  </span>
  
                    
	<span class="article-tag">
		<i class="icon icon-tag"></i>
		<a class="article-tag-link-link" href="/tags/Linux/" rel="tag">Linux</a>
	</span>
	
                      
	<span class="article-read hidden-xs">
		<i class="icon icon-pageviews" aria-hidden="true"></i>
		<span id="busuanzi_container_page_pv">
			<span id="busuanzi_value_page_pv">0</span>
		</span>
	</span>
	
		
                        <span class="post-comment"><i class="icon icon-comment"></i> <a
                            href="/2019/02/17/Linux-user-sudo/#comments" class="article-comment-link">
                            评论
                          </a></span>
                        
	
		<span class="post-wordcount hidden-xs" itemprop="wordCount">字数统计: 9.1k(字)</span>
	
	
		<span class="post-readcount hidden-xs" itemprop="timeRequired">阅读时长: 35(分)</span>
	

              </div>
      </div>
      <div class="article-entry marked-body" itemprop="articleBody">
        
                  <p>Linux 系统是一个多用户多任务的分时操作系统，任何一个要使用系统资源的用户，都必须首先向系统管理员申请一个账号，然后以这个账号的身份进入系统。</p>
<p>用户的账号一方面可以帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也可以帮助用户组织文件，并为用户提供安全性保护。</p>
<p>每个用户账号都拥有一个惟一的用户名和各自的口令。</p>
<p>用户在登录时键入正确的用户名和口令后，就能够进入系统和自己的主目录。</p>
<h2 id="实现用户账号的管理，要完成的工作主要有如下几个方面："><a href="#实现用户账号的管理，要完成的工作主要有如下几个方面：" class="headerlink" title="实现用户账号的管理，要完成的工作主要有如下几个方面："></a>实现用户账号的管理，要完成的工作主要有如下几个方面：</h2><ol>
<li><p>用户账号的添加、删除与修改。</p>
</li>
<li><p>用户口令的管理。</p>
</li>
<li><p>用户组的管理。</p>
</li>
</ol>
<p>注：此说明适用于Debian、Redhat、suse、Ubuntu、Fedora等众多linux系统，并对多少位没有区别。</p>
<h2 id="用户分类："><a href="#用户分类：" class="headerlink" title="用户分类："></a>用户分类：</h2><ol>
<li>超级用户 UID=0 root</li>
<li>普通用户 UID500起。由超级用户或者具有超级用户权限的用户创建的用户</li>
<li>虚拟用户 UID 1-499 存在满足文件或服务启动的需要。一般不能登录系统，只是傀儡</li>
<li>用户关联的四个文件：/etc/passwd  /etc/shadow  /etc/group  /etc/gshadow</li>
</ol>
<h1 id="一、管理用户命令汇总："><a href="#一、管理用户命令汇总：" class="headerlink" title="一、管理用户命令汇总："></a>一、管理用户命令汇总：</h1><table>
<thead>
<tr>
<th align="left">命令</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">useradd</td>
<td align="left">同adduser命令，执行此命令可在系统中添加用户</td>
</tr>
<tr>
<td align="left">userdel</td>
<td align="left">删除用户及相关用户的配置文件</td>
</tr>
<tr>
<td align="left">passwd</td>
<td align="left">为用户设置密码。更改/etc/shadow</td>
</tr>
<tr>
<td align="left">chage</td>
<td align="left">修改用户密码有效期限。管理/etc/shadow</td>
</tr>
<tr>
<td align="left">usermod</td>
<td align="left">修改用户命令，可以通过usermod来修改登录名，用户的家目录等等</td>
</tr>
<tr>
<td align="left">id</td>
<td align="left">查看用户的UID , GID及所归属的用户组</td>
</tr>
<tr>
<td align="left">su</td>
<td align="left">用户角色切换命令</td>
</tr>
<tr>
<td align="left">sudo</td>
<td align="left">sudo是通过另一个用户来执行命令，su是用户来切换用户，然后通过切换到的用户来完成相应的任务，但sudo能在命令后面直接接命令执行，如：sudo ls /root，不需要root密码就可以执行只有root才能执行相应的命令或具备的目录权限；这个权限需要通过visudo命令或编辑/etc/sudoers来实现</td>
</tr>
<tr>
<td align="left">visudo</td>
<td align="left">visudo配置sudo权限的编辑命令；也可以不用这个命令，直接用vi来编辑/etc/sudoers实现。但推荐用visudo来操作（会自动检查语法）</td>
</tr>
</tbody></table>
<p>其它与用户管理相关的命令，可了解，但不要深入研究！掌握重点即可！</p>
<h1 id="二、-etc-skel-目录"><a href="#二、-etc-skel-目录" class="headerlink" title="二、/etc/skel 目录"></a>二、/etc/skel 目录</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@ubuntu:/# ll -a /etc/skel</span><br><span class="line">    total 40</span><br><span class="line">    drwxr-xr-x   2 root root  4096 Dec  1 10:13 ./</span><br><span class="line">    drwxr-xr-x 142 root root 12288 Jan 25 16:19 ../</span><br><span class="line">    -rw-r--r--   1 root root   220 Sep  1  2015 .bash_logout</span><br><span class="line">    -rw-r--r--   1 root root  3771 Sep  1  2015 .bashrc</span><br><span class="line">    -rw-r--r--   1 root root  8980 Apr 20  2016 examples.desktop</span><br><span class="line">    -rw-r--r--   1 root root   655 May 16  2017 .profile</span><br></pre></td></tr></table></figure>
<p>作用：/etc/skel 目录是用来存放新用户配置文件的目录，当我们添加新用户时，这个目录下的所有文件会自动被复制到新添加的用户的家目录下；默认情况下/etc/skel 目录下的所有文件都是隐藏文件（以点开头的文件）；通过修改，添加，删除/etc/skel目录下的文件，我们可为新创建的用户提供统一的，标准的，初始化用户环境。</p>
<p><strong>企业面试题：当新建了一个用户，该用户登录时出现如下提示：请问是什么原因？如何解决？</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@gin ~]# su - gin</span><br><span class="line">    -bash-4.1$</span><br><span class="line">    -bash-4.1$</span><br></pre></td></tr></table></figure>
<p>解答：出现这种情况的原因是环境变量有问题，解决方案就是拷贝/etc/skel目录下以bash开头的文件到当前用户的家目录即可！</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@centos home]# mkdir /home/gin</span><br><span class="line">[root@centos home]# cp -a /etc/skel/.bash* ./gin</span><br><span class="line">[root@centos home]# chmod -R 700 gin</span><br><span class="line">[root@centos home]# chown gin:gin -R gin</span><br></pre></td></tr></table></figure>

<h1 id="三、-etc-login-defs配置文件"><a href="#三、-etc-login-defs配置文件" class="headerlink" title="三、/etc/login.defs配置文件"></a>三、/etc/login.defs配置文件</h1><p>/etc/login.defs 是设置用户帐号限制的文件。该文件里的配置对root用户无效。</p>
<p>如果/etc/shadow文件里有相同的选项，则以/etc/shadow里的设置为准，也就是说/etc/shadow的配置优先级高于/etc/login.defs</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"># *REQUIRED* required</span><br><span class="line">#  Directory where mailboxes reside, _or_ name of file, relative to the</span><br><span class="line">#   home directory.  If you _do_ define both, MAIL_DIR takes precedence.</span><br><span class="line">#   QMAIL_DIR is for Qmail</span><br><span class="line">#</span><br><span class="line">#QMAIL_DIR      Maildir</span><br><span class="line">MAIL_DIR        /var/spool/mail</span><br><span class="line">#创建用户时，要在目录/var/spool/mail中创建一个用户mail文件</span><br><span class="line">#MAIL_FILE      .mail</span><br><span class="line"> </span><br><span class="line"># Password aging controls:</span><br><span class="line">#</span><br><span class="line">#       PASS_MAX_DAYS   Maximum number of days a password may be used.</span><br><span class="line">#       PASS_MIN_DAYS   Minimum number of days allowed between password changes.</span><br><span class="line">#       PASS_MIN_LEN    Minimum acceptable password length.</span><br><span class="line">#       PASS_WARN_AGE   Number of days warning given before a password expires.</span><br><span class="line">#</span><br><span class="line">PASS_MAX_DAYS   99999</span><br><span class="line">#密码最大有效期</span><br><span class="line">PASS_MIN_DAYS   0</span><br><span class="line">#两次修改密码的最小间隔时间</span><br><span class="line">PASS_MIN_LEN    5</span><br><span class="line">#密码最小长度，对于root无效</span><br><span class="line">PASS_WARN_AGE   7</span><br><span class="line">#密码过期前多少天开始提示</span><br><span class="line">#</span><br><span class="line"># Min/max values for automatic uid selection in useradd</span><br><span class="line">#创建用户时不指定UID的话自动UID的范围</span><br><span class="line">UID_MIN                   500</span><br><span class="line">#用户ID的最小值</span><br><span class="line">UID_MAX                 60000</span><br><span class="line">#用户ID的最大值</span><br><span class="line">#</span><br><span class="line"># Min/max values for automatic gid selection in groupadd</span><br><span class="line">#自动组ID的范围</span><br><span class="line">GID_MIN                   500</span><br><span class="line">#组ID的最小值</span><br><span class="line">GID_MAX                 60000</span><br><span class="line">#组ID的最大值</span><br><span class="line"> </span><br><span class="line">#</span><br><span class="line"># If defined, this command is run when removing a user.</span><br><span class="line"># It should remove any at/cron/print jobs etc. owned by</span><br><span class="line"># the user to be removed (passed as the first argument).</span><br><span class="line">#</span><br><span class="line">#USERDEL_CMD    /usr/sbin/userdel_local</span><br><span class="line">#当删除用户的时候执行的脚本</span><br><span class="line"> </span><br><span class="line">#</span><br><span class="line"># If useradd should create home directories for users by default</span><br><span class="line"># On RH systems, we do. This option is overridden with the -m flag on</span><br><span class="line"># useradd command line.</span><br><span class="line">#</span><br><span class="line">CREATE_HOME     yes</span><br><span class="line">#使用useradd的时候是够创建用户目录</span><br><span class="line"> </span><br><span class="line"># The permission mask is initialized to this value. If not specified,</span><br><span class="line"># the permission mask will be initialized to 022.</span><br><span class="line">UMASK           077</span><br><span class="line"> </span><br><span class="line"># This enables userdel to remove user groups if no members exist.</span><br><span class="line">#</span><br><span class="line">USERGROUPS_ENAB yes</span><br><span class="line">#用MD5加密密码</span><br></pre></td></tr></table></figure>

<p>为什么新建用户时会从该目录下拷贝文件到用户家目录呢？<br>因为有/etc/default/useradd文件的存在！~</p>
<h1 id="四、-etc-default-useradd-文件"><a href="#四、-etc-default-useradd-文件" class="headerlink" title="四、/etc/default/useradd 文件"></a>四、/etc/default/useradd 文件</h1><p>/etc/default/useradd 文件是在使用useradd添加用户时的一个需要调用的一个默认的配置文件，可以使用“useradd -D”参数，这样的命令格式来修改文件里的内容。该文件的内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@gin gin]# cat /etc/default/useradd</span><br><span class="line"># useradd defaults file</span><br><span class="line">GROUP=100                   ## 表示 用户组ID （依赖于/etc/login.defs的USERGROUPS_ENAB参数，如果为no，则由此处控制）</span><br><span class="line">HOME=/home                  ## 把用户家目录建在/home中</span><br><span class="line">INACTIVE=-1                 ## 是否启用账号过期停权，-1表示不启用</span><br><span class="line">EXPIRE=                     ## 账号是否启用过期设置    无表示不启用</span><br><span class="line">SHELL=/bin/bash                 ## 账号使用shell种类</span><br><span class="line">SKEL=/etc/skel                  ## 配置新用户目录的默认文件存放路径</span><br><span class="line">CREATE_MAIL_SPOOL=yes               ## 是否创建邮箱缓存  yes表示创建</span><br></pre></td></tr></table></figure>
<p>如：修改EXPIRE的值为2015/06/10：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@Gin scripts]# useradd -D -e 2015/06/10</span><br><span class="line">[root@Gin scripts]# cat /etc/default/useradd</span><br><span class="line"># useradd defaults file</span><br><span class="line">GROUP=100</span><br><span class="line">HOME=/home</span><br><span class="line">INACTIVE=-1</span><br><span class="line">EXPIRE=2015/06/10</span><br><span class="line">SHELL=/bin/bash</span><br><span class="line">SKEL=/etc/skel</span><br><span class="line">CREATE_MAIL_SPOOL=yes</span><br></pre></td></tr></table></figure>
<h1 id="五、Linux系统用户账号的管理"><a href="#五、Linux系统用户账号的管理" class="headerlink" title="五、Linux系统用户账号的管理"></a>五、Linux系统用户账号的管理</h1><p>用户账号的管理工作主要涉及到用户账号的添加、修改和删除。添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录Shell等资源。刚添加的账号是被锁定的，无法使用。</p>
<p>useradd命令修改的文件：/etc/passwd , /etc/shadow , /etc/group , /etc/gshadow</p>
<p>控制useradd命令默认行为的文件：/etc/default/useradd , /etc/login.defs</p>
<h2 id="添加新的用户账号"><a href="#添加新的用户账号" class="headerlink" title="添加新的用户账号"></a>添加新的用户账号</h2><p>当使用useradd命令不加参数选项，后面直接跟所添加的用户名时，系统首先会读取配置文件/etc/login.defs and /etc/default/useradd中的定义的参数或规则，根据设置的规则添加用户，同时会向/etc/passwd and /etc/group文件添加新建用户和用户组记录。</p>
<p>当然/etc/passwd and /etc/group的加密资讯文件/etc/shadow and /etc/gshadow也会同步生成记录，同时系统还会根据/etc/default/useradd文件中所配置的信息建立用户的家目录，并复制/etc/skel中的所有文件（包括隐藏的环境配置文件）到新用户的家目录中。</p>
<p>添加新用户帐号使用useradd命令，其语法及选项如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd 选项 用户名</span><br></pre></td></tr></table></figure>

<pre><code>-c comment 指定一段注释性描述。
-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，可以创建主目录。
-g 用户组 指定用户所属的用户组。
-G 用户组，用户组 指定用户所属的附加组。
-s Shell文件 指定用户的登录Shell。
-u 用户号 指定用户的用户号，如果同时有-o选项，则可以重复使用其他用户的标识号。
-e expire_date 账号终止日期，日期的指定格式为 MM/DD/YY
-f inactive_days 账号过期几日后永久停权。当值为0时账号则立刻停权。为-1时则关闭此功能，预设值为-1
-m 自动建立用户的登入目录。
-M 不要自动建立用户的登入目录。
-n 取消建立以用户名称为名的群组。
-r 创建系统账户
</code></pre>
<h3 id="例1：-d-m参数的使用"><a href="#例1：-d-m参数的使用" class="headerlink" title="例1：-d , -m参数的使用"></a>例1：-d , -m参数的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd –d /home/olcs -m sam</span><br></pre></td></tr></table></figure>
<p>此命令创建了一个用户sam，<br>其中-d和-m选项用来为登录名sam产生一个主目录/home/olcs（/home为默认的用户主目录所在的父目录）。</p>
<h3 id="例2：-s-G参数的使用"><a href="#例2：-s-G参数的使用" class="headerlink" title="例2：-s , -G参数的使用"></a>例2：-s , -G参数的使用</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">useradd -s /bin/bash -g olcs –G olcs,root gem</span><br></pre></td></tr></table></figure>
<p>此命令新建了一个用户gem，该用户的登录Shell是/bin/bash，它属于olcs用户组，同时又属于root用户组，其中olcs用户组是其主组。</p>
<h3 id="例3：-e参数的使用-（指定账户什么时候过期）"><a href="#例3：-e参数的使用-（指定账户什么时候过期）" class="headerlink" title="例3：-e参数的使用 （指定账户什么时候过期）"></a>例3：-e参数的使用 （指定账户什么时候过期）</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@Andy andy]# date -s 01/18/2012            #修改系统时间</span><br><span class="line">[root@Andy andy]# useradd tmpuser1 -e 01/19/12      #增加一个tmpuser1用户，并指定2012年1月19号过期</span><br><span class="line">[root@Andy andy]# date -s 01/21/12</span><br><span class="line">Sat Jan 21 00:00:00 CST 2012</span><br></pre></td></tr></table></figure>
<p>#系统更改时间为2012年1月21号，而上面建立的用户过期时间是2012年1月19号，此时切换到tmpuser1用户，发现还是可以登录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@Andy andy]# chage -l tmpuser1</span><br><span class="line">Last password change                                    : Jan 17, 2012</span><br><span class="line">Password expires                                        : never</span><br><span class="line">Password inactive                                       : never</span><br><span class="line">Account expires                                         : Jan 19, 2012   #过期时间的确是19号，设置没错</span><br><span class="line">Minimum number of days between password change          : 0</span><br><span class="line">Maximum number of days between password change          : 99999</span><br><span class="line">Number of days of warning before password expires       : 7</span><br></pre></td></tr></table></figure>
<p>为什么还是可以切换到tmpuser1用户呢？<br>1）通过-e设置后无法远程SSH连接，但是可以用 su 切换，账户并未被锁定<br>2）账户过期时间和系统时间，需要相差2天(该测试是在CentOS5.x版本，CentOS6版本不相差2天)<br>再次测试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Andy andy]# useradd tmpuser2 -e 01/22/12</span><br><span class="line">[root@Andy andy]# passwd tmpuser2</span><br></pre></td></tr></table></figure>
<p>我们在SSH客户端用tmpuser2登录，不要用su进行切换！为了让账户过期，我们再次修改系统时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@Andy andy]# date -s 01/23/12</span><br><span class="line">[root@Andy andy]# clock -w          #重新读取系统时间</span><br><span class="line">[root@Andy andy]# date +%F</span><br><span class="line">2012-01-23</span><br></pre></td></tr></table></figure>
<p>当tmpuser2账户退出登录后，再次登录时，就会提示：</p>
<p>Your account has expired; please contact your system administrator</p>
<p>用户的过期时间当然也可以使用usermod命令来修改：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@gin gin]# usermod -e &quot;216/10/10&quot; zhangsansan</span><br></pre></td></tr></table></figure>
<p>指定用户过期时间</p>
<h3 id="例4：useradd-c-u-G-s-d-多个参数组合例子"><a href="#例4：useradd-c-u-G-s-d-多个参数组合例子" class="headerlink" title="例4：useradd -c -u -G -s -d 多个参数组合例子"></a>例4：useradd -c -u -G -s -d 多个参数组合例子</h3><p>自定义用户的家目录，shell类型，所归属的用户组等：添加用户poe6，并设置其用户注释信息为HandsomeBoy，UID指定为806，归属为用户组root , poe , sa成员，其shell类型为/bin/sh，设置家目录为/poe6</p>
<p>[root@gin gin]# useradd -c “HandsomeBoy” -u 806 -G root,poe,sa -s /bin/sh -d /poe6 poe6</p>
<h2 id="这三个组必须要先存在"><a href="#这三个组必须要先存在" class="headerlink" title="这三个组必须要先存在"></a>这三个组必须要先存在</h2><p>增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件如/etc/shadow, /etc/group等。</p>
<p>Linux提供了集成的系统管理工具userconf，它可以用来对用户账号进行统一管理。</p>
<p>生产场景中创建用户的完整命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@Andy andy]# groupadd -g 801 sa</span><br><span class="line">[root@Andy andy]# useradd -g sa -u 901 ett</span><br><span class="line">[root@Andy andy]# echo &quot;who123&quot;|passwd --stdin ett</span><br><span class="line">Changing password for user ett.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">[root@Andy andy]# visudo -c</span><br><span class="line">[root@Andy andy]# history -c</span><br></pre></td></tr></table></figure>
<h2 id="删除帐号"><a href="#删除帐号" class="headerlink" title="删除帐号"></a>删除帐号</h2><p>如果一个用户的账号不再使用，可以从系统中删除。删除用户账号就是要将/etc/passwd等系统文件中的该用户记录删除，必要时还删除用户的主目录。删除一个已有的用户账号使用userdel命令，其格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel 选项 用户名</span><br></pre></td></tr></table></figure>
<p>常用的选项是-r，它的作用是把用户的主目录一起删除。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel -r olcs</span><br></pre></td></tr></table></figure>
<p>此命令删除用户olcs在系统文件中（主要是/etc/passwd, /etc/shadow, /etc/group等）的记录，同时删除用户的主目录。</p>
<h2 id="修改帐号"><a href="#修改帐号" class="headerlink" title="修改帐号"></a>修改帐号</h2><p>修改用户账号就是根据实际情况更改用户的有关属性，如用户号、主目录、用户组、登录Shell等。</p>
<p>修改已有用户的信息使用usermod命令，其格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod 选项 用户名</span><br></pre></td></tr></table></figure>
<p>常用的选项包括-c, -d, -m, -g, -G, -s, -u以及-o等，这些选项的意义与useradd命令中的选项一样，可以为用户指定新的资源值。</p>
<p>另外，有些系统可以使用如下选项：</p>
<table>
<thead>
<tr>
<th align="left">usermod参数选项</th>
<th align="left">注释说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-c  comment</td>
<td align="left">增加用户账号/etc/passwd中的注解说明栏（第5栏）</td>
</tr>
<tr>
<td align="left">-d  home_dir</td>
<td align="left">更新用户新的家目录，组合-m选项，用户旧的家目录会搬到新的家目录去，如旧的家目录不存在则创建新的家目录</td>
</tr>
<tr>
<td align="left">-e  expire_date</td>
<td align="left">加上用户账号停止日期。格式为MM/DD/YY</td>
</tr>
<tr>
<td align="left">-f  inactive_days</td>
<td align="left">账号过期几日后永久停权。当值为0时账号则立刻被停权。而当值为-1时则关闭此功能。预设值为-1</td>
</tr>
<tr>
<td align="left">-g  initial_group</td>
<td align="left">更新用户的起始登入用户组。用户组名须已存在。用户组ID必须参照既有的用户组，用户组ID预设值为1</td>
</tr>
<tr>
<td align="left">-G  group.[..]</td>
<td align="left">定义用户为一堆groups的成员，每个用户组使用逗号分隔</td>
</tr>
<tr>
<td align="left">-l  login_name</td>
<td align="left">修改用户login时的名称为login_name，其余信息不变</td>
</tr>
<tr>
<td align="left">-s  shell</td>
<td align="left">指定登录shell</td>
</tr>
<tr>
<td align="left">-u  uid</td>
<td align="left">指定用户UID值。除非接-o参数（usermode -u 505 -o andy），否则ID值必须是唯一的数字（不能为负数）</td>
</tr>
<tr>
<td align="left">-L</td>
<td align="left">冻结用户的密码。实际就是间接修改/etc/shadow的密码栏。在密码栏的开头加上！号，即表示冻结。这个冻结密码的功能和usermod -e , useradd -e , chage -E , passwd -l 等命令参数都有类似的功效，那就是让用户无法正常登陆</td>
</tr>
<tr>
<td align="left">-U</td>
<td align="left">取消冻结的密码，使之恢复登陆，实际同样是修改/etc/shadow的密码栏，在密码栏的开头取消“！ ”号，即表示恢复</td>
</tr>
</tbody></table>
<h3 id="实例1：usermod-c修改-etc-passwd中用户的说明栏"><a href="#实例1：usermod-c修改-etc-passwd中用户的说明栏" class="headerlink" title="实例1：usermod -c修改/etc/passwd中用户的说明栏"></a>实例1：usermod -c修改/etc/passwd中用户的说明栏</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# tail -1 /etc/passwd         #--&gt;为了进行对比，在修改前进行查看</span><br><span class="line">andy:x:802:803::/home/andy:/bin/bash</span><br><span class="line">[root@centos andy]# usermod -c &quot;AndyLaw&quot; andy</span><br><span class="line">[root@bruce bruce]# tail -1 /etc/passwd</span><br><span class="line">andy:x:802:803:AndyLaw:/home/andy:/bin/bash</span><br></pre></td></tr></table></figure>

<h3 id="实例2：测试-c-u-G-s-d等参数！要求添加用户andy6，并设置用户注释为HandsomeBoy，UID指定为806，归属为用户组root，andy-sa成员，其shell类型为-bin-sh，设置家目录为-andy6"><a href="#实例2：测试-c-u-G-s-d等参数！要求添加用户andy6，并设置用户注释为HandsomeBoy，UID指定为806，归属为用户组root，andy-sa成员，其shell类型为-bin-sh，设置家目录为-andy6" class="headerlink" title="实例2：测试 -c , -u , -G , -s , -d等参数！要求添加用户andy6，并设置用户注释为HandsomeBoy，UID指定为806，归属为用户组root，andy , sa成员，其shell类型为/bin/sh，设置家目录为/andy6"></a>实例2：测试 -c , -u , -G , -s , -d等参数！要求添加用户andy6，并设置用户注释为HandsomeBoy，UID指定为806，归属为用户组root，andy , sa成员，其shell类型为/bin/sh，设置家目录为/andy6</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# useradd -c HandsomeBoy -u 806 -s /bin/sh -G root,andy,sa -d /andy6 andy6</span><br><span class="line">[root@bruce bruce]# grep andy6 /etc/passwd</span><br><span class="line">andy6:x:806:806:HandsomeBoy:/andy6:/bin/sh</span><br><span class="line">[root@bruce bruce]# id andy6</span><br><span class="line">uid=806(andy6) gid=806(andy6) groups=806(andy6),0(root),803(andy),804(sa)</span><br></pre></td></tr></table></figure>

<p>提示：在添加新用户时，如果不使用-n参数，系统会自动创建一个与用户同名的用户组，如本例就自动生成了一个andy6的用户组</p>
<p>下面使用usermod命令进行修改 : 要求注释改为uptowngirl，UID修改为1806，归属修改为用户组root , sa成员，其shell类型修改为/bin/tcsh，设置家目录为/tmp/andy6：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# usermod -c uptowngirl -u 1806 -G root,sa -s /bin/tcsh -d /tmp/andy6</span><br></pre></td></tr></table></figure>
<h3 id="实例3：使用户在2016-11-15后过期-usermod-e"><a href="#实例3：使用户在2016-11-15后过期-usermod-e" class="headerlink" title="实例3：使用户在2016-11-15后过期 usermod -e"></a>实例3：使用户在2016-11-15后过期 usermod -e</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# usermod -e 2016-11-26 andy6</span><br><span class="line">[root@bruce bruce]# chage -l andy6</span><br><span class="line">Last password change                                    : Nov 24, 2016</span><br><span class="line">Password expires                                        : never</span><br><span class="line">Password inactive                                       : never</span><br><span class="line">Account expires                                         : Nov 26, 2016</span><br><span class="line">Minimum number of days between password change          : 0</span><br><span class="line">Maximum number of days between password change          : 99999</span><br><span class="line">Number of days of warning before password expires       : 7</span><br></pre></td></tr></table></figure>
<h3 id="实例4：冻结andy6用户的密码-usermod-L"><a href="#实例4：冻结andy6用户的密码-usermod-L" class="headerlink" title="实例4：冻结andy6用户的密码 usermod -L"></a>实例4：冻结andy6用户的密码 usermod -L</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# grep andy6 /etc/shadow</span><br><span class="line">andy6:$6$V/bwRYJd$aUnJt/DUupmwv00G8kCzmqg61Z0GWCU7aNp7rgeA.YFb2PROvqcZM.WVIlqZjesmIfQgoJR/QoL6b.VdrLybd.:17129:0:99999:7::17131:</span><br><span class="line">[root@bruce bruce]# usermod -L andy6</span><br><span class="line">[root@bruce bruce]# grep andy6 /etc/shadow</span><br><span class="line">andy6:!$6$V/bwRYJd$aUnJt/DUupmwv00G8kCzmqg61Z0GWCU7aNp7rgeA.YFb2PROvqcZM.WVIlqZjesmIfQgoJR/QoL6b.VdrLybd.:17129:0:99999:7::17131:</span><br><span class="line">[root@bruce bruce]# usermod -U andy6</span><br></pre></td></tr></table></figure>
<h2 id="用户口令的管理"><a href="#用户口令的管理" class="headerlink" title="用户口令的管理"></a>用户口令的管理</h2><p>用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，但是被系统锁定，无法使用，必须为其指定口令后才可以使用，即使是指定空口令。</p>
<p>指定和修改用户口令的Shell命令是passwd。超级用户可以为自己和其他用户指定口令，普通用户只能用它修改自己的口令。命令的格式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd 选项 用户名</span><br></pre></td></tr></table></figure>
<p>可使用的选项：</p>
<pre><code>-l , --lock 锁定口令，即禁用账号。
-u , --unlock 口令解锁。
-d , --delete 使账号无口令。
-f , --force 强迫用户下次登录时修改口令。
--stdin 从stdin读入密码 (root only) , 如果默认用户名，则修改当前用户的口令。
-n , --minimun=DAYS 两次密码修改的最小天数，后面接数字，仅root权限操作
-x , --maximun=DAYS     两次密码修改的最大天数，后面接数字，仅root权限操作
-w , --warning=DAYS     在距多少天提醒用户修改密码，仅root权限操作
-i ，--inactive=DASY 在密码过期后多少天，用户被禁掉，仅root权限操作
-S , --status               查询用户的密码状态，仅root权限操作
</code></pre>
<h3 id="实例1：我们用-l参数来锁定andy用户，使之不能修改密码，然后再用-u参数来解除锁定"><a href="#实例1：我们用-l参数来锁定andy用户，使之不能修改密码，然后再用-u参数来解除锁定" class="headerlink" title="实例1：我们用-l参数来锁定andy用户，使之不能修改密码，然后再用-u参数来解除锁定"></a>实例1：我们用-l参数来锁定andy用户，使之不能修改密码，然后再用-u参数来解除锁定</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# passwd -S andy              #锁定前查看andy账户的状态</span><br><span class="line">andy PS 2016-11-24 0 99999 7 -1 (Password set, SHA512 crypt.)</span><br><span class="line">[root@bruce bruce]# grep andy /etc/shadow       #查看andy账户的密码状态</span><br><span class="line">andy:$6$i5dcb9oB$6U2HlaHJqIVZWZNElMgzab.Y7M5nALaE/PT54kq2hrrP6hGjmbQhoqVktDTlX5Kxt.JyB.RNlm.7PkYFO7odG0:17129:0:99999:7:::</span><br><span class="line">[root@bruce bruce]# passwd -l andy</span><br><span class="line">Locking password for user andy.</span><br><span class="line">passwd: Success</span><br><span class="line">[root@bruce bruce]# grep andy /etc/shadow       #再次查看密码状态，发现密码前多了两个!!号</span><br><span class="line">andy:!!$6$i5dcb9oB$6U2HlaHJqIVZWZNElMgzab.Y7M5nALaE/PT54kq2hrrP6hGjmbQhoqVktDTlX5Kxt.JyB.RNlm.7PkYFO7odG0:17129:0:99999:7:::</span><br></pre></td></tr></table></figure>
<p>#锁定之后，用andy账户登录系统，再修改密码会提示：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[andy@bruce ~]$ passwd</span><br><span class="line">passwd: Authentication token manipulation error</span><br></pre></td></tr></table></figure>
<p>#解除锁定</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# passwd -u andy</span><br><span class="line">Unlocking password for user andy.</span><br><span class="line">passwd: Success</span><br><span class="line">[root@bruce bruce]# grep andy /etc/shadow       #解除锁定后，/etc/shadow文件中密码字段前面两个！！号消失</span><br><span class="line">andy:$6$i5dcb9oB$6U2HlaHJqIVZWZNElMgzab.Y7M5nALaE/PT54kq2hrrP6hGjmbQhoqVktDTlX5Kxt.JyB.RNlm.7PkYFO7odG0:17129:0:99999:7:::</span><br></pre></td></tr></table></figure>
<h3 id="实例2：举一个组合参数-x-n-w-i控制密码时效的例子。要求andy用户7天内不能更改密码，60天以后必须修改密码，过期前10天通知andy用户，过期后30天后禁止用户登陆"><a href="#实例2：举一个组合参数-x-n-w-i控制密码时效的例子。要求andy用户7天内不能更改密码，60天以后必须修改密码，过期前10天通知andy用户，过期后30天后禁止用户登陆" class="headerlink" title="实例2：举一个组合参数-x -n -w -i控制密码时效的例子。要求andy用户7天内不能更改密码，60天以后必须修改密码，过期前10天通知andy用户，过期后30天后禁止用户登陆"></a>实例2：举一个组合参数-x -n -w -i控制密码时效的例子。要求andy用户7天内不能更改密码，60天以后必须修改密码，过期前10天通知andy用户，过期后30天后禁止用户登陆</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@bruce bruce]# passwd -n 7 -x 60 -w 10 -i 30 andy</span><br><span class="line">Adjusting aging data for user andy.</span><br><span class="line">passwd: Success</span><br></pre></td></tr></table></figure>
<p>#当然使用chage命令也可以实现同样的效果只是参数略有不同：chage -m 7 -M 60 -W 10 -I 30 andy</p>
<p>在root账户下修改andy的密码，然后回到andy账户，再次修改密码出现如下提示：</p>
<p>passwd: Authentication token manipulation error</p>
<p>例如，假设当前用户是olcs，则下面的命令修改该用户自己的口令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ passwd</span><br><span class="line">Old password:******</span><br><span class="line">New password:*******</span><br><span class="line">Re-enter new password:*******</span><br></pre></td></tr></table></figure>
<p>如果是超级用户，可以用下列形式指定任何用户的口令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># passwd olcs</span><br><span class="line">New password:*******</span><br><span class="line">Re-enter new password:*******</span><br></pre></td></tr></table></figure>
<p>普通用户修改自己的口令时，passwd命令会先询问原口令，验证后再要求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而超级用户为用户指定口令时，就不需要知道原口令。</p>
<p>为了系统安全起见，用户应该选择比较复杂的口令，例如最好使用8位长的口令，口令中包含有大写、小写字母和数字，并且应该与姓名、生日等不相同。</p>
<p>为用户指定空口令时，执行下列形式的命令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># passwd -d sam</span><br></pre></td></tr></table></figure>
<p>此命令将用户sam的口令删除，这样用户sam下一次登录时，系统就不再询问口令。<br>passwd命令还可以用-l(lock)选项锁定某一用户，使其不能登录，例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># passwd -l olcs</span><br></pre></td></tr></table></figure>
<p>–stdin方式修改设置密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@gin gin]# echo 123456|passwd --stdin gin</span><br><span class="line">Changing password for user gin.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br><span class="line">[root@gin gin]# echo 123 &gt; p.log</span><br><span class="line">[root@gin gin]# passwd --stdin gin &lt; p.log</span><br><span class="line">Changing password for user gin.</span><br><span class="line">passwd: all authentication tokens updated successfully.</span><br></pre></td></tr></table></figure>
<p>备注：/usr/bin/passwd  是修改用户密码的程序 密码记录在 /etc/shadow</p>
<p> /etc/passwd是用户数据库，其中的域给出了用户名、加密口令和用户的其他信息. /etc/shadow是在安装了影子(shadow)口令软件的系统上的影子口令文件。影子口令文件将/etc/passwd 文件中的加密口令移动到/etc/shadow中，而后者只对超级用户( r o o t )可读。</p>
<p> Linux /etc/shadow文件中的记录行与/etc/passwd中的一一对应,它由pwconv命令根据/etc/passwd中的数据自动产生。</p>
<h2 id="口令时效"><a href="#口令时效" class="headerlink" title="口令时效"></a>口令时效</h2><p>口令时效是系统管理员用来防止机构内不良口令的一种技术。在Linux系统上，口令时效是通过chage命令来管理的，格式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chage [option] username </span><br></pre></td></tr></table></figure>
<p>下面列出了chage命令的选项说明：</p>
<pre><code>-m days： 指定用户必须改变口令所间隔的最少天数。如果值为0，口令就不会过期。
-M days： 指定口令有效的最多天数。当该选项指定的天数加上-d选项指定的天数小于当前的日期时，用户在使用该帐号前就必须改变口令。
-d days： 指定从1970年1月1日起，口令被改变的天数。
-E date： 指定帐号被锁的日期。日期格式YYYY-MM-DD。若不用日期，也可以使用自1970年1月1日后经过的天数。
-W days： 指定口令过期前要警告用户的天数。
-I --inactive： 在密码过期后多少天，用户被禁掉，仅能以root操作
-l --list ：显示账户年龄信息
</code></pre>
<p>该命令记住两个参数-E , -l即可，其它的选项可以使用passwd来替代！</p>
<p>例如下面的命令要求用户user1两天内不能更改口令，并且口令最长的存活期为30天，口令过期前5天通知用户</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chage -m 2 -M 30 -W 5 user1</span><br></pre></td></tr></table></figure>
<p>可以使用如下命令查看用户user1当前的口令时效信息：chage -l user1</p>
<p><strong>提示：</strong></p>
<p>1）可以使用chage 进入交互模式修改用户的口令时效。</p>
<p>2）修改口令实质上就是修改影子口令文件/etc/shadow中与口令时效相关的字段值。</p>
<h1 id="Linux系统用户组的管理"><a href="#Linux系统用户组的管理" class="headerlink" title="Linux系统用户组的管理"></a>Linux系统用户组的管理</h1><p>每个用户都有一个用户组，系统可以对一个用户组中的所有用户进行集中管理。不同Linux 系统对用户组的规定有所不同，如Linux下的用户属于与它同名的用户组，这个用户组在创建用户时同时创建。用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就是对/etc/group文件的更新。</p>
<table>
<thead>
<tr>
<th align="left">参数选项</th>
<th align="left">注释说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">-g</td>
<td align="left">指定用户组GID值。除非接-o参数（如：groupadd -g 1234 -o andy），否则ID值必须是唯一的数字（不能为负数）。如果不指定-g参数，则预设值会从500开始。</td>
</tr>
<tr>
<td align="left">-r</td>
<td align="left">建立系统用户组。GID值会比/etc/login.defs中定义的UID_MIN值小。如：groupadd -r ett;grep ett /etc/group #–&gt;分号分隔两个命令 ett:x:105: #–&gt;GID为105，小于500了</td>
</tr>
<tr>
<td align="left">-f</td>
<td align="left">新增一个账户，强制覆盖一个已经存在的用户组账号。</td>
</tr>
</tbody></table>
<h2 id="增加一个新的用户组"><a href="#增加一个新的用户组" class="headerlink" title="增加一个新的用户组"></a>增加一个新的用户组</h2><p>增加一个新的用户组使用groupadd命令，其格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd 选项 用户组</span><br></pre></td></tr></table></figure>
<p>可以使用的选项有：</p>
<pre><code>-g GID 指定新用户组的组标识号（GID）。
-o 一般与-g选项同时使用，表示新用户组的GID可以与系统已有用户组的GID相同。
</code></pre>
<h3 id="例1："><a href="#例1：" class="headerlink" title="例1："></a>例1：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupadd olcs</span><br></pre></td></tr></table></figure>
<p>此命令向系统中增加了一个新组olcs，新组的组标识号是在当前已有的最大组标识号的基础上加1。</p>
<h3 id="例2："><a href="#例2：" class="headerlink" title="例2："></a>例2：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#groupadd -g 101 group1</span><br></pre></td></tr></table></figure>
<p>此命令向系统中增加了一个新组group2，同时指定新组的组标识号是101。</p>
<h2 id="删除已有用户组"><a href="#删除已有用户组" class="headerlink" title="删除已有用户组"></a>删除已有用户组</h2><p>如果要删除一个已有的用户组，使用groupdel命令，其格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel 用户组</span><br></pre></td></tr></table></figure>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#groupdel group1</span><br></pre></td></tr></table></figure>
<p>此命令从系统中删除组group1。</p>
<h2 id="修改用户组的属性"><a href="#修改用户组的属性" class="headerlink" title="修改用户组的属性"></a>修改用户组的属性</h2><p>修改用户组的属性使用groupmod命令。其语法如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupmod 选项 用户组</span><br></pre></td></tr></table></figure>
<p>常用的选项有：</p>
<pre><code>-g GID 为用户组指定新的组标识号。
-o 与-g选项同时使用，用户组的新GID可以与系统已有用户组的GID相同。
-n新用户组 将用户组的名字改为新名字
</code></pre>
<h3 id="例1：-1"><a href="#例1：-1" class="headerlink" title="例1："></a>例1：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupmod -g 102 group1</span><br></pre></td></tr></table></figure>
<p>此命令将组group1的组标识号修改为102。</p>
<h3 id="例2：-1"><a href="#例2：-1" class="headerlink" title="例2："></a>例2：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupmod –g 10000 -n group2 group1</span><br></pre></td></tr></table></figure>
<p>此命令将组group1的标识号改为10000，组名修改为group2。</p>
<h2 id="用户在用户组间切换"><a href="#用户在用户组间切换" class="headerlink" title="用户在用户组间切换"></a>用户在用户组间切换</h2><p>如果一个用户同时属于多个用户组，那么用户可以在用户组之间切换，以便具有其他用户组的权限。用户可以在登录后，使用命令newgrp切换到其他用户组，这个命令的参数就是目的用户组。例如： </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ newgrp root</span><br></pre></td></tr></table></figure>
<p>这条命令将当前用户切换到root用户组，前提条件是root用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也可以通过集成的系统管理工具来完成。让Linux系统中的普通用户也有超级用户的权限</p>
<h1 id="目录权限管理"><a href="#目录权限管理" class="headerlink" title="目录权限管理"></a>目录权限管理</h1><h2 id="3种基本权限"><a href="#3种基本权限" class="headerlink" title="3种基本权限"></a>3种基本权限</h2><p>在Linux中，将使用系统资源的人员分为4类：超级用户、文件或目录的属主、属主的同组人和其他人员。超级用户拥有对Linux系统一切操作权限，对于其他3类用户都要指定对文件和目录的访问权限。</p>
<table>
<thead>
<tr>
<th align="left">代表字符</th>
<th>对应数值</th>
<th>权限</th>
<th>对文件的含义</th>
<th>对目录的含义</th>
</tr>
</thead>
<tbody><tr>
<td align="left">r</td>
<td>4</td>
<td>读</td>
<td>可以读文件的内容</td>
<td>可以列出目录中的文件列表</td>
</tr>
<tr>
<td align="left">w</td>
<td>2</td>
<td>写</td>
<td>可以修改该文件</td>
<td>可以在目录中创建删除文件</td>
</tr>
<tr>
<td align="left">x</td>
<td>1</td>
<td>可执行</td>
<td>可以执行该文件</td>
<td>可以使用cd命令进入该目录</td>
</tr>
<tr>
<td align="left">-</td>
<td>0</td>
<td>无</td>
<td></td>
<td></td>
</tr>
</tbody></table>
<h2 id="查看文件和目录的权限"><a href="#查看文件和目录的权限" class="headerlink" title="查看文件和目录的权限"></a>查看文件和目录的权限</h2><p>可以使用带l参数的ls命令查看文件或目录的权限</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@Gin scripts]# ll /gin</span><br><span class="line">total 12</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jan 28 23:15 python</span><br><span class="line">drwxr-xr-x 2 root root 4096 Feb  1 13:11 scripts</span><br><span class="line">drwxr-xr-x 5 root root 4096 Jan 25 18:01 tools</span><br></pre></td></tr></table></figure>
<p>每一行显示一个文件或目录的信息，这些信息包括文件的类型、文件的权限、文件的属主和文件的所属组，还有文件的大小以及创建时间和文件名。输出列表中每 一行第一列的第一个字母指示了该文件的类型。各种文件类型及代表字符如下：</p>
<ul>
<li>-：普通文件    </li>
<li>b：块文件设备，是特殊的文件类型</li>
<li>d：目录文件 ，事实上在ext2fs中，目录是一个特殊的文件</li>
<li>c：字符文件设备 ，是特殊的文件类型</li>
<li>l：符号链接文件，实际上它指向另一个文件</li>
<li>s、p：管道文件，这些文件关系到系统的数据结构和管道，通常很少见到</li>
</ul>
<p>第一列的其余9个字母可分为三组，3个字母一组，这3组分别代表：文件属主的权限、文件所属组的权限和其他用户的权限。每组中的3个栏位分别表示读、 写、执行权限。</p>
<p>第2～10个字符当中的每3个为一组，左边三个字符表示所有者权限，中间3个字符表示与所有者同一组的用户的权限，右边3个字符是其他用户的权限。这三个一组共9个字符，代表的意义如下：</p>
<p>r(Read，读取)：对文件而言，具有读取文件内容的权限；对目录来说，具有浏览目录的权限。</p>
<p>w(Write,写入)：对文件而言，具有新增、修改文件内容的权限；对目录来说，具有删除、移动目录内文件的权限。</p>
<p>x(eXecute，执行)：对文件而言，具有执行文件的权限；对目录了来说该用户具有进入目录的权限。</p>
<p>－：表示不具有该项权限。</p>
<h2 id="更改操作权限（chmod-chown）"><a href="#更改操作权限（chmod-chown）" class="headerlink" title="更改操作权限（chmod/chown）"></a>更改操作权限（chmod/chown）</h2><p>系统管理员和文件属主可以根据需要来设置文件的权限，有两种设置方法：文字设定法和数值设定法。</p>
<h3 id="文字设定法"><a href="#文字设定法" class="headerlink" title="文字设定法"></a>文字设定法</h3><p>chomd的文字设定法的格式为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod [ugoa][+-=][rwxugo]</span><br></pre></td></tr></table></figure>
<p>第1个选项表示要赋予权限的用户，具体说明如下：<br>    u：属主      g：所属组用户      o：其他用户      a：所有用户<br>第2个选项表示要进行的操作，具体说明如下：<br>    +：增加权限      -：删除权限      =：分配权限，同时将原有权限删除<br>第3个选项是要分配的权限，具体说明如下：<br>    r/x/w：允许读取/写入/执行        u/g/o：和属主/所属组用户/其他用户的权限相同<br>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod go -r users      //取消组用户和其他用户对文件users的读取权限</span><br><span class="line">chmod u+x users      //对文件users的属主增加招待权限</span><br><span class="line">chmod u+x,go-r users      //对文件users的属主添加执行权限，同时取消组用户和其他用户对文件的读取权限</span><br></pre></td></tr></table></figure>
<h3 id="数值设定法"><a href="#数值设定法" class="headerlink" title="数值设定法"></a>数值设定法</h3><p>chmod的数值设定法的格式为：chmod n1n2n3<br>其中n1、n2、n3分别代表属主的权限、组用户的权限和其他用户的权限，这三个选项都是八进制数字。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chmod 755 adduser      //对文件adduser的属设置可读、写和执行的权限，所属组和其他用户只设置读和执行权限，没有写权限</span><br><span class="line">chmod 600 user1         //取消组用户和其他用户对文件user1的一切权限（原权限为-rw-rCrC）</span><br></pre></td></tr></table></figure>
<p>备注：如想一次修改某个目录下所有文件的权限，包括子目录中的文件权限也要修改，要使用参数－R表示启动递归处理。</p>
<p>网站搬家特别是从虚拟空间或windows上搬到linux VPS上会出现文件权限问题，通常目录都是755权限，文件是644权限。<br>首先cd到你要修改的网站目录，然后运行如下两个命令即可快速批量修改权限。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">find -type d|xargs chmod 755</span><br><span class="line">find -type f|xargs chmod 644</span><br></pre></td></tr></table></figure>
<h2 id="更改属组或同组人"><a href="#更改属组或同组人" class="headerlink" title="更改属组或同组人"></a>更改属组或同组人</h2><p>改变文件的属主和组可以用chown命令，命令格式为：chown [-R] 。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chown osmond user1      //将文件user1的属主改为osmond</span><br><span class="line">chown osmond.osmond user1      //将文件user1的属主和组都改成osmond</span><br><span class="line">chown -R osmond.osmond mydir      //将mydir目录及其子目录下的所有文件或目录的属主和组都改成osmond</span><br></pre></td></tr></table></figure>

<h2 id="设置文件和目录的生成掩码"><a href="#设置文件和目录的生成掩码" class="headerlink" title="设置文件和目录的生成掩码"></a>设置文件和目录的生成掩码</h2><p>用户可以使用umask命令设置文件夹的默认生成掩码。默认的生成掩码告诉系统当创建一个文件或目录时不应该赋予哪些权限。如果用户将umask命令放在环境文件（.bash_profile）中，就可以控制所有的新建文件或目录的访问权限。其命令格式为：umask [u1u2u3]其中，u1、u2、u3分别表示的是不允许属主有的权限、不允许同组人有的权限和不允许其他人有的权限。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umask 022      //设置不允许同组用户和其他用户有写权限 umask            //显示当前的默认生成掩码</span><br></pre></td></tr></table></figure>
<p>用法非常简单，只需执行umask 777 命令，便代表屏蔽所有的权限，因而之后建立的文件或目录，其权限都变成000，依次类推。通常root帐号搭配umask命令的数值为022、027和077，普通用户则是采用002，这样所产生的权限依次为755、750、700、775。</p>
<p>用户登录系统时，用户环境就会自动执行rmask命令来决定文件、目录的默认权限。</p>
<h2 id="特殊权限设置"><a href="#特殊权限设置" class="headerlink" title="特殊权限设置"></a>特殊权限设置</h2><h3 id="SUID、SGID和sticky-bit"><a href="#SUID、SGID和sticky-bit" class="headerlink" title="SUID、SGID和sticky-bit"></a>SUID、SGID和sticky-bit</h3><p>除了上述的基本权限之外，还有所谓的特殊权限存在。由于特殊权限会拥有一些“特权”，因而用户若无特殊需要，不应该去打开这些权限，避免安全方面出现严重漏洞，甚至摧毁系统。下面列出了3个特殊权限的说明：</p>
<p>SUID：当一个设置了SUID位的可执行文件被执行时，该文件以所有者的身份运行，也就是说无论谁来执行这个文件，他都拥有文件所有者的特权，可以任意存取该文件拥有者能使用的全部系统资源。如果所有者是root，那么执行人就有超级用户的特权了。</p>
<p>SGID：当一个设置了SGID位的可执行文件被执行时，该文件将具有所属组的特权，任意存取整个组所能使用的系统资源；若一个目录设置了SGID，则所有被复制到这个目录下的文件，其所属的组都会被重设为和这个目录一样，除非在复制文件时加上-p（preserve，保留文件属性）参数，才能保留原来 所属的群组设置。</p>
<p>sticky-bit：对一个文件设置了sticky-bit之后，尽管其他用户有写权限，也必须由属主执行删除、移动等操作，对一个目录设置了 sticky-bit之后，存放在该目录下的文件仅允许其属主执行删除、移动等操作。</p>
<p>一个设置了SUID的典型例子是passwd程序，它允许普通用户改变自己的口令，这是通过改变/etc/shadow文件的口令字段来实现的。然而系 统管理员决不允许普通用户拥有直接改变/etc/shadow文件的权限。解决方法是将passwd程序设置SUID，当passwd被执行时将拥有超级用户的权限，而passwd程序运行结束又回到普通用户的权限，下面是显示passwd程序的权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Gin scripts]# ll /usr/bin/passwd</span><br><span class="line">-rwsr-xr-x. 1 root root 30768 Feb 22  2012 /usr/bin/passwd</span><br></pre></td></tr></table></figure>
<p>一个设置了sticky-bit的典型例子是系统临时文件目录/tmp，这避免了不守法的用户存心搞鬼，恣意乱删其他用户存放的文件。下面显示/tmp 目录的权限：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@Gin scripts]# ll -d /tmp</span><br><span class="line">drwxrwxrwt. 8 root root 4096 Feb  1 18:04 /tmp</span><br></pre></td></tr></table></figure>
<h3 id="SUID、SGID和sticky-bit的表示"><a href="#SUID、SGID和sticky-bit的表示" class="headerlink" title="SUID、SGID和sticky-bit的表示"></a>SUID、SGID和sticky-bit的表示</h3><p>从上面的显示可以看出，SUID是占用属主的x位置为表示的；SGID是占用组的x位置来表示的；sticky-bit是占用其他人的x位置来表示 的。在表示上有大小定之分，假若同时设置执行权限和SUID、SGID和sticky-bit，权限标识字符是小写的；倘若关闭执行权限，则标识字符会变成大写。</p>
<h3 id="设置特殊权限"><a href="#设置特殊权限" class="headerlink" title="设置特殊权限"></a>设置特殊权限</h3><p>使用chmod命令设置特殊权限，仍然有字符设定法和数值设定法之分。使用字符设定法时，可以使用s和t权限字符，</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod u+s /usr/bin/myapp      //为程序/usr/bin/myapp添加SUID权限</span><br><span class="line">chmod g+s /home/groupspace      //为目录/home/groupspace添加SGID权限</span><br><span class="line">chmod o+t /home/share      //为目录/home/share添加sticky-bit权限</span><br></pre></td></tr></table></figure>
<p>使用chmod的数值设定法时，要使用4位八进制数值，其中第一位八进制数用于设置特殊权限，后三位八进制数用于设置基本权限。</p>
<p>例如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod 4755 /usr/bin/myapp      //设置SUID</span><br><span class="line">chmod 2755 /home/groupspace      //设置SGID</span><br><span class="line">chmod 1755 /home/share     //设置sticky-bit</span><br></pre></td></tr></table></figure>
                    
      </div>
      <div class="article-footer">
        <blockquote class="mt-2x">
  <ul class="post-copyright list-unstyled">
    
      <li class="post-copyright-link hidden-xs">
        <strong>本文链接：</strong>
        <a href="https://merlinahh.github.io/2019/02/17/Linux-user-sudo/" title="Linux 用户管理及用户权限设置" target="_blank" rel="external">
          https://merlinahh.github.io/2019/02/17/Linux-user-sudo/
        </a>
      </li>
      
        <li class="post-copyright-license">
          <strong>版权声明： </strong> 本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh"
            target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！
        </li>
  </ul>
</blockquote>

  
    <div class="panel panel-default panel-badger">
      <div class="panel-body">
        <figure class="media">
          <div class="media-left">
            <a href="https://github.com/MerlinAhh" target="_blank" class="img-burn thumb-sm">
              <img src="/images/avatar.jpg"
                class="img-rounded w-full" alt="">
            </a>
          </div>
          <div class="media-body">
            <h3 class="media-heading"><a href="https://github.com/MerlinAhh" target="_blank"><span class="text-dark">
                  Merlin
                </span><small class="ml-1x">
                  Frontend Developer
                </small></a></h3>
            <div>
              一个前端。
            </div>
          </div>
        </figure>
      </div>
    </div>
    
      </div>
  </article>
  
    
  <section id="comments">
  	
      <div id="vcomments"></div>
    
  </section>


      
</div>

  <nav class="bar bar-footer clearfix" data-stick-bottom>
  <div class="bar-inner">
  
  <ul class="pager pull-left">
    
    <li class="prev">
      <a href="/2019/02/17/timestamp-to-time/" title="时间戳转时间格式函数"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a>
    </li>
    
    
    <li class="next">
      <a href="/2019/02/14/Linux-install-Nginx/" title="Linux 系统 Nginx 安装与配置"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a>
    </li>
    
    
  </ul>
  
  
  <!-- Button trigger modal -->
  <button type="button" class="btn btn-fancy btn-donate pop-onhover bg-gradient-warning" data-toggle="modal" data-target="#donateModal"><span>赏</span></button>
  <!-- <div class="wave-icon wave-icon-danger btn-donate" data-toggle="modal" data-target="#donateModal">
    <div class="wave-circle"><span class="icon"><i class="icon icon-bill"></i></span></div>
  </div> -->
  
  
  <div class="bar-right">
    
    <div class="share-component" data-sites="weibo,qq,wechat,facebook,twitter" data-mobile-sites="weibo,qq,qzone"></div>
    
  </div>
  </div>
</nav>
    
  <!-- Modal -->
  <div class="modal modal-center modal-small modal-xs-full fade" id="donateModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content donate">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
            aria-hidden="true">&times;</span></button>
        <div class="modal-body">
          <div class="donate-box">
            <div class="donate-head">
              <p>
                感谢您的支持，我会继续努力的!
              </p>
            </div>
            <div class="tab-content">
              <div role="tabpanel" class="tab-pane fade active in" id="alipay">
                <div class="donate-payimg">
                  <img src="/images/donate/alipayimg.png" alt="扫码支持"
                    title="扫一扫" />
                </div>
                <p class="text-muted mv">
                  扫码打赏，你说多少就多少
                </p>
                <p class="text-grey">
                  打开支付宝扫一扫，即可进行扫码打赏哦
                </p>
              </div>
              <div role="tabpanel" class="tab-pane fade" id="wechatpay">
                <div class="donate-payimg">
                  <img src="/images/donate/wechatpayimg.png" alt="扫码支持"
                    title="扫一扫" />
                </div>
                <p class="text-muted mv">
                  扫码打赏，你说多少就多少
                </p>
                <p class="text-grey">
                  打开微信扫一扫，即可进行扫码打赏哦
                </p>
              </div>
            </div>
            <div class="donate-footer">
              <ul class="nav nav-tabs nav-justified" role="tablist">
                <li role="presentation" class="active">
                  <a href="#alipay" id="alipay-tab" role="tab" data-toggle="tab" aria-controls="alipay"
                    aria-expanded="true"><i class="icon icon-alipay"></i>
                    支付宝
                  </a>
                </li>
                <li role="presentation" class="">
                  <a href="#wechatpay" role="tab" id="wechatpay-tab" data-toggle="tab" aria-controls="wechatpay"
                    aria-expanded="false"><i class="icon icon-wxpay"></i>
                    微信支付
                  </a>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
      
  </main>
                  <footer class="footer" itemscope itemtype="http://schema.org/WPFooter">
    
	
    <ul class="social-links">
    	
        <li><a href="https://github.com/MerlinAhh" target="_blank" title="Github-Fill" ><i class="icon icon-github-fill"></i></a></li>
        
        <li><a href="https://huaban.com/user/merlinahh" target="_blank" title="Huaban" ><i class="icon icon-huaban"></i></a></li>
        
        <li><a href="/atom.xml" target="_blank" title="Rss-Fill" ><i class="icon icon-rss-fill"></i></a></li>
        
    </ul>

        <div class="copyright">
            
                &copy; 2025
                    Merlin
                        
                            <!-- <div class="publishby">
        	Theme by <a href="https://github.com/cofess" target="_blank"> cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.
        </div> -->
        </div>
</footer>
                    <script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script>
   window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')
</script>

<script src="/js/plugin.min.js"></script>

   
<script src="/js/application.js"></script>

      
    <script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>



    <script>
(function ($) {
    $('.search-form').on('submit', function (e) {
        var keyword = $('.search-form-input[name="wd"]').val();
        window.location = 'https://www.baidu.com/s?wd=site:merlinahh.github.io ' + keyword;
        return false;
    });
})(jQuery);
</script>

         
                  
                           
                              
	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
	

		
                                 
                                    
                                       
    
  <!-- <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script> -->
  <script src="//cdn.jsdelivr.net/npm/valine"></script>
  <script type="text/javascript">
    var GUEST = ['nick', 'mail', 'link'];
    var meta = 'nick,mail,link';
    meta = meta.split(',').filter(function (item) {
      return GUEST.indexOf(item) > -1;
    });
    new Valine({
      el: '#vcomments',
      verify: false,
      notify: false,
      appId: '6NTC9mbUIM3jxuA1JvFo91mv-9Nh9j0Va',
      appKey: 'DBFJJEIgASRXDdtCrKqD65DB',
      placeholder: 'Just go go',
      avatar: 'mm',
      meta: meta,
      pageSize: '10' || 10,
      visitor: false
  });
  </script>
       

                                          
                                             
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.3.5/dist/jquery.fancybox.min.js"></script>
  <script>
    //利用 FancyBox 实现点击图片放大
    $(document).ready(function () {
      $('article img').not('[hidden]').not('.panel-body img').each(function () {
        var $image = $(this);
        var imageCaption = $image.attr('alt');
        var $imageWrapLink = $image.parent('a');
        if ($imageWrapLink.length < 1) {
          var src = this.getAttribute('src');
          var idx = src.lastIndexOf('?');
          if (idx != -1) {
            src = src.substring(0, idx);
          }
          $imageWrapLink = $image.wrap('<a href="' + src + '"></a>').parent('a');
        }
        $imageWrapLink.attr('data-fancybox', 'images');
        if (imageCaption) {
          $imageWrapLink.attr('data-caption', imageCaption);
        }
      });
      $().fancybox({
        selector: '[data-fancybox="images"]',
        hash: false,
        loop: false,
      });
    });
  </script>
  
                                                


                                                   <!-- 监听用户停留页面 -->
<script type="text/javascript">
    var normal_title = document.title;
    document.addEventListener('visibilitychange', function () {
        if (document.visibilityState == 'hidden') {
            document.title = '肥来接着看鸭(づ￣ 3￣)づ~~~';
        } else {
            document.title = normal_title;
        }
    });
</script><!-- 禁止用户复制+f12 -->
<script type="text/javascript">
    // 禁止右键
    if (window.Event)
        document.captureEvents(Event.MOUSEUP);

    function nocontextmenu() {
        event.cancelBubble = true
        event.returnValue = false;
        return false;
    }

    function norightclick(e) {
        if (window.Event) {
            if (e.which == 2 || e.which == 3) return false;
        } else if (event.button == 2 || event.button == 3) {
            event.cancelBubble = true
            event.returnValue = false;
            return false;
        }
    }
    document.oncontextmenu = nocontextmenu;  // for IE5+
    document.onmousedown = norightclick;  //for all others
    // 禁止f12
    document.oncontextmenu = function () { return false; };
    document.onkeydown = function () {
        if (window.event && window.event.keyCode == 123) {
            event.keyCode = 0;
            event.returnValue = false;
            return false;
        }
    };
    // 禁止选中
    document.onselectstart = function (event) {
        if (window.event) {
            event = window.event;
        } try {
            var the = event.srcElement;
            if (!((the.tagName == "INPUT" && the.type.toLowerCase() == "text") || the.tagName == "TEXTAREA")) {
                return false;
            }
            return true;
        } catch (e) {
            return false;
        }
    };
</script>
      </body>

      </html>